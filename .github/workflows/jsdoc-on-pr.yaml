      - name: Push docs and prune old docs branches
        env:
          # name of the branch that will hold the docs for this source branch
          DOCS_BRANCH: docs/${{ github.ref_name }}
        run: |
          set -e

          git config --global user.name  "github-actions[bot]"
          git config --global user.email "41898282+github-actions[bot]@users.noreply.github.com"

          # ─── create/update the docs branch ─────────────────────────────
          git switch --orphan "$DOCS_BRANCH"
          git rm -r --cached . >/dev/null 2>&1 || true    # remove everything from index
          git add -f docs                                 # keep only docs

          if git diff --cached --quiet; then
            echo "Docs unchanged - skipping push"
          else
            git commit -m "Update JSDoc documentation for $DOCS_BRANCH"
            git push --force origin "$DOCS_BRANCH"
          fi

          # ─── prune ALL other docs/* branches ──────────────────────────
          echo "Cleaning up old docs branches…"
          for ref in $(git ls-remote --heads origin "refs/heads/docs/*" | awk '{print $2}'); do
            branch=${ref#refs/heads/}
            if [[ "$branch" != "$DOCS_BRANCH" ]]; then
              echo "Deleting $branch"
              git push origin --delete "$branch"
            fi
          done
